ğŸ“ Audit run directory: audit_results/audit_run_20251027_213829
ğŸ“ Logs will be saved to: audit_results/audit_run_20251027_213829/audit.log
ğŸ” Full audit mode: Running quality checks and profiling/insights

======================================================================
ğŸ’° Estimating BigQuery scan costs...
======================================================================
âœ… Connected to BIGQUERY

ğŸ” Pre-fetching metadata for 2 table(s)...
âœ… Metadata cached for all tables
   ğŸ“Š fct_avaibility_part: Estimating ALL columns (relationship detection or no filters)
   ğŸ” Estimating query: SELECT * FROM `dbt_prod.fct_avaibility_part` ORDER BY RAND() LIMIT 10000
   ğŸ“Š dim_station: Estimating ALL columns (relationship detection or no filters)
   ğŸ” Estimating query: SELECT * FROM `dbt_prod.dim_station`

ğŸ“Š Estimated bytes to scan per table:
   â€¢ fct_avaibility_part: 474.40 MB (sampled)
   â€¢ dim_station: 112.29 KB

ğŸ’¾ Total estimated data to scan: 0.47 GB (0.0005 TB)
ğŸ’µ Estimated cost (on-demand): $0.00 USD

âš ï¸  Do you want to proceed with the audit?
   Type 'y' or 'yes' to continue, or 'n' to cancel: 
âš ï¸  Running in non-interactive mode, proceeding with audit...
   (Use --yes flag in future to skip this prompt)

âœ… Proceeding with audit...

======================================================================
ğŸ” Auditing table: fct_avaibility_part
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: portfolio-402.dbt_prod.fct_avaibility_part
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 3,877,353 rows
ğŸ”¹ Partitioned by: collected_at (TIME)
ğŸ”¸ Clustered by: station_code
ğŸ“Š Loading all 13 columns
ğŸ” Sampling 10,000 rows from table using 'random' method
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: fct_avaibility_part
Total rows in table: 3,877,353
Analyzing sample: 10,000 rows
============================================================

âŒ Error auditing table 'fct_avaibility_part': Unknown check: 'trailing_characters'. Available checks: 
Traceback (most recent call last):
  File "/Users/v/Documents/GitHub/database_audit/audit.py", line 352, in main
    results = auditor.audit_from_database(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 444, in audit_from_database
    results = self.audit_table(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 614, in audit_table
    col_results = self._audit_column(df, col, col_check_config, primary_key_columns, audit_mode)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 772, in _audit_column
    results = run_check_sync('trailing_characters', df, col, primary_key_columns)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/runner.py", line 107, in run_check_sync
    return asyncio.run(
  File "/Users/v/anaconda3/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/v/anaconda3/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/runner.py", line 56, in run_check
    raise ValueError(
ValueError: Unknown check: 'trailing_characters'. Available checks: 

======================================================================
ğŸ” Auditing table: dim_station
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: portfolio-402.dbt_prod.dim_station
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 1,587 rows
ğŸ”‘ Primary key from config: station_code
ğŸ“Š Loading all 9 columns
âœ… Loaded 1,587 rows into memory

============================================================
Auditing: dim_station
Total rows in table: 1,587
============================================================

âŒ Error auditing table 'dim_station': Unknown check: 'uniqueness'. Available checks: 
Traceback (most recent call last):
  File "/Users/v/Documents/GitHub/database_audit/audit.py", line 352, in main
    results = auditor.audit_from_database(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 444, in audit_from_database
    results = self.audit_table(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 614, in audit_table
    col_results = self._audit_column(df, col, col_check_config, primary_key_columns, audit_mode)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 982, in _audit_column
    results = run_check_sync('uniqueness', df, col, primary_key_columns)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/runner.py", line 107, in run_check_sync
    return asyncio.run(
  File "/Users/v/anaconda3/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/Users/v/anaconda3/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/runner.py", line 56, in run_check
    raise ValueError(
ValueError: Unknown check: 'uniqueness'. Available checks: 

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251027_213829
â±ï¸  Total duration: 19.63 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251027_213829/audit.log
======================================================================
ğŸ”’ Closed BIGQUERY connection
