ğŸ“ Audit run directory: audit_results/audit_run_20251020_165906
ğŸ“ Logs will be saved to: audit_results/audit_run_20251020_165906/audit.log

======================================================================
ğŸ” Auditing table: fct_avaibility
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.fct_avaibility
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 24,417,603 rows
ğŸ” Sampling 10,000 rows from table
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: fct_avaibility
Total rows in table: 24,417,603
Analyzing sample: 10,000 rows
============================================================


ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_code                   Int64           - NOT_CHECKED 0 (0.0%)        1,492          
station_name                   String          âœ— ERROR      0 (0.0%)        1,489          
capacity                       Int64           - NOT_CHECKED 6 (0.1%)        73             
docks_available                Int64           - NOT_CHECKED 0 (0.0%)        66             
mechanical                     Int64           - NOT_CHECKED 0 (0.0%)        63             
ebike                          Int64           - NOT_CHECKED 0 (0.0%)        40             
duedate                        Datetime(time_unit='ns', time_zone='UTC') âœ“ OK         0 (0.0%)        9,975          
bikes_available                Int64           - NOT_CHECKED 0 (0.0%)        68             
rate_bike_available            Float64         - NOT_CHECKED 959 (9.6%)      1,054          
rate_dock_available            Float64         - NOT_CHECKED 959 (9.6%)      1,048          
bikes_out_of_order             Int64           - NOT_CHECKED 6 (0.1%)        92             
collected_at                   Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,583          
rounded_collected_at           Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,582          
====================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š station_code:
   Top 5 Values:
      â€¢ '41210.0' (17x, 0.2%)
      â€¢ '20118.0' (16x, 0.2%)
      â€¢ '12129.0' (16x, 0.2%)
      â€¢ '21024.0' (15x, 0.1%)
      â€¢ '7111.0' (15x, 0.1%)
   Stats: min=1001.00, max=92008.00, mean=18865.56, median=16140.00
   Quantiles: p25=11043.00, p50=16140.00, p75=22015.00

ğŸ“Š station_name:
   Top 10 Values:
      â€¢ 'Place Nelson Mandela' (17x, 0.2%)
      â€¢ 'HÃ´tel de ville de Fontenay-sous-Bois' (17x, 0.2%)
      â€¢ 'Bois de Vincennes - Porte Jaune' (16x, 0.2%)
      â€¢ 'Orteaux - Mouraud' (16x, 0.2%)
      â€¢ 'MutualitÃ©' (15x, 0.1%)
      â€¢ 'Billancourt - GÃ©nÃ©ral Leclerc' (15x, 0.1%)
      â€¢ 'Cardinal Lavigerie' (15x, 0.1%)
      â€¢ 'Place de l'Insurrection d'AoÃ»t 1944' (15x, 0.1%)
      â€¢ 'Ecole Militaire - Place Joffre' (15x, 0.1%)
      â€¢ 'SÃ¨vres-Gallieni' (14x, 0.1%)
   Length: min=0, max=50, avg=23.97

ğŸ“Š capacity:
   Top 5 Values:
      â€¢ '0.0' (953x, 9.5%)
      â€¢ '30.0' (593x, 5.9%)
      â€¢ '20.0' (498x, 5.0%)
      â€¢ '28.0' (413x, 4.1%)
      â€¢ '25.0' (404x, 4.0%)
   Stats: min=0.00, max=78.00, mean=28.53, median=28.00
   Quantiles: p25=21.00, p50=28.00, p75=36.00

ğŸ“Š docks_available:
   Top 5 Values:
      â€¢ '19.0' (389x, 3.9%)
      â€¢ '16.0' (368x, 3.7%)
      â€¢ '17.0' (363x, 3.6%)
      â€¢ '13.0' (337x, 3.4%)
      â€¢ '14.0' (334x, 3.3%)
   Stats: min=0.00, max=71.00, mean=18.80, median=18.00
   Quantiles: p25=10.00, p50=18.00, p75=26.00

ğŸ“Š mechanical:
   Top 5 Values:
      â€¢ '0.0' (1,729x, 17.3%)
      â€¢ '1.0' (1,331x, 13.3%)
      â€¢ '2.0' (973x, 9.7%)
      â€¢ '3.0' (715x, 7.1%)
      â€¢ '4.0' (544x, 5.4%)
   Stats: min=0.00, max=67.00, mean=7.47, median=4.00
   Quantiles: p25=1.00, p50=4.00, p75=11.00

ğŸ“Š ebike:
   Top 5 Values:
      â€¢ '2.0' (1,542x, 15.4%)
      â€¢ '1.0' (1,534x, 15.3%)
      â€¢ '3.0' (1,311x, 13.1%)
      â€¢ '4.0' (1,029x, 10.3%)
      â€¢ '0.0' (1,016x, 10.2%)
   Stats: min=0.00, max=43.00, mean=4.44, median=3.00
   Quantiles: p25=1.00, p50=3.00, p75=6.00

ğŸ“Š duedate:
   Date Range: from 2018-08-15 08:35:22+00:00 to 2025-10-19 21:44:04+00:00 (2622 days)
   Most Common Dates:
      â€¢ 2024-02-22 (73x, 0.7%)
      â€¢ 2024-10-04 (29x, 0.3%)
      â€¢ 2025-09-13 (26x, 0.3%)
      â€¢ 2025-06-05 (26x, 0.3%)
      â€¢ 2024-07-16 (26x, 0.3%)

ğŸ“Š bikes_available:
   Top 5 Values:
      â€¢ '2.0' (688x, 6.9%)
      â€¢ '3.0' (675x, 6.8%)
      â€¢ '4.0' (671x, 6.7%)
      â€¢ '1.0' (612x, 6.1%)
      â€¢ '5.0' (574x, 5.7%)
   Stats: min=0.00, max=74.00, mean=11.90, median=9.00
   Quantiles: p25=4.00, p50=9.00, p75=17.00

ğŸ“Š rate_bike_available:
   Top 5 Values:
      â€¢ '0.0' (287x, 3.2%)
      â€¢ '0.5' (146x, 1.6%)
      â€¢ '0.2' (128x, 1.4%)
      â€¢ '0.3333333333333333' (122x, 1.3%)
      â€¢ '0.25' (121x, 1.3%)
   Stats: min=0.00, max=42.00, mean=0.43, median=0.30
   Quantiles: p25=0.13, p50=0.30, p75=0.60

ğŸ“Š rate_dock_available:
   Top 5 Values:
      â€¢ '0.0' (196x, 2.2%)
      â€¢ '1.0' (163x, 1.8%)
      â€¢ '0.5' (149x, 1.6%)
      â€¢ '0.8' (140x, 1.5%)
      â€¢ '0.75' (125x, 1.4%)
   Stats: min=0.00, max=41.00, mean=0.65, median=0.67
   Quantiles: p25=0.36, p50=0.67, p75=0.84

ğŸ“Š bikes_out_of_order:
   Top 5 Values:
      â€¢ '0.0' (3,809x, 38.1%)
      â€¢ '1.0' (2,673x, 26.7%)
      â€¢ '2.0' (1,341x, 13.4%)
      â€¢ '3.0' (623x, 6.2%)
      â€¢ '4.0' (232x, 2.3%)
   Stats: min=-73.00, max=34.00, mean=-2.16, median=1.00
   Quantiles: p25=0.00, p50=1.00, p75=1.00

ğŸ“Š collected_at:
   Date Range: from 2023-10-25 00:05:10 to 2025-10-20 02:06:17 (726 days)
   Most Common Dates:
      â€¢ 2025-09-13 (27x, 0.3%)
      â€¢ 2024-11-12 (26x, 0.3%)
      â€¢ 2025-02-28 (26x, 0.3%)
      â€¢ 2025-06-05 (25x, 0.2%)
      â€¢ 2024-07-28 (25x, 0.2%)

ğŸ“Š rounded_collected_at:
   Date Range: from 2023-10-25 00:00:00 to 2025-10-20 02:00:00 (726 days)
   Most Common Dates:
      â€¢ 2025-09-13 (27x, 0.3%)
      â€¢ 2024-11-12 (26x, 0.3%)
      â€¢ 2025-02-28 (26x, 0.3%)
      â€¢ 2025-06-05 (25x, 0.2%)
      â€¢ 2024-07-28 (25x, 0.2%)

ğŸ” Issues Found:

ğŸ“Š Column: station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,489
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,945 rows (39.5%)
      Found chars: ['Ã§', 'Ãª', 'Ã´', 'Ã‰', 'Ã¨', 'Ã¢', 'Ã»', 'Ã«', "'", 'Ã©']
      Examples: ['Charles Tillon - CimetiÃ¨re Communal', 'GÃ©nÃ©ral Leclerc - RÃ©publique']


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.033s
   â€¢ date_checks: 0.011s
   â€¢ Total: 0.07s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 1.119s
   â€¢ Metadata: 6.043s
   â€¢ Data Loading: 3.840s
   â€¢ Audit Checks: 0.075s
   â€¢ Total Table Audit: 0.07s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251020_165906/audit_fct_avaibility.html
ğŸ“„ Results saved to: audit_results/audit_run_20251020_165906/audit_fct_avaibility.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251020_165906/audit_fct_avaibility.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251020_165906/audit_fct_avaibility_summary.csv

======================================================================
ğŸ” Auditing table: dim_station
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.dim_station
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 1,587 rows
ğŸ”‘ Primary key from config: station_code
âœ… Loaded 1,587 rows into memory

============================================================
Auditing: dim_station
Total rows in table: 1,587
============================================================


ğŸ”‘ Potential primary key column(s): station_code, lat

ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_code                   Int64           - NOT_CHECKED 0 (0.0%)        1,587          
station_name                   String          âœ“ OK         0 (0.0%)        1,570          
capacity                       Int64           - NOT_CHECKED 0 (0.0%)        72             
lon                            Float64         - NOT_CHECKED 0 (0.0%)        1,586          
lat                            Float64         - NOT_CHECKED 0 (0.0%)        1,587          
city                           String          âœ“ OK         0 (0.0%)        68             
is_renting                     Boolean         - NOT_CHECKED 0 (0.0%)        2              
is_returning                   Boolean         - NOT_CHECKED 0 (0.0%)        2              
station_plus                   Boolean         - NOT_CHECKED 0 (0.0%)        2              
====================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š station_code:
   Stats: min=1001.00, max=92008.00, mean=19021.43, median=17007.00
   Quantiles: p25=11042.00, p50=17007.00, p75=22304.00

ğŸ“Š station_name:
   Top 10 Values:
      â€¢ 'Evariste Galois' (2x, 0.1%)
      â€¢ 'ChÃ¢teau - RÃ©publique' (2x, 0.1%)
      â€¢ 'Place de la Gare' (2x, 0.1%)
      â€¢ 'Gaston Roussel - Commune de Paris' (2x, 0.1%)
      â€¢ 'Verdun - Carnot' (2x, 0.1%)
      â€¢ 'RenÃ© Boulanger - Lancry' (2x, 0.1%)
      â€¢ 'Simon Bolivar - Henri Turot' (2x, 0.1%)
      â€¢ 'Les PlanÃ¨tes' (2x, 0.1%)
      â€¢ 'Place Nelson Mandela' (2x, 0.1%)
      â€¢ 'Square Bela Bartok' (2x, 0.1%)
   Length: min=6, max=58, avg=23.88

ğŸ“Š capacity:
   Top 5 Values:
      â€¢ '30.0' (93x, 5.9%)
      â€¢ '20.0' (82x, 5.2%)
      â€¢ '28.0' (72x, 4.5%)
      â€¢ '0.0' (71x, 4.5%)
      â€¢ '25.0' (68x, 4.3%)
   Stats: min=0.00, max=1200.00, mean=31.57, median=29.00
   Quantiles: p10=17.00, p25=22.00, p50=29.00, p75=37.00, p90=50.00, p95=56.00, p99=68.00

ğŸ“Š lon:
   Top 5 Values:
      â€¢ '2.4345204234123234' (2x, 0.1%)
      â€¢ '2.2915423' (1x, 0.1%)
      â€¢ '2.2416052222251897' (1x, 0.1%)
      â€¢ '2.3110256868292' (1x, 0.1%)
      â€¢ '2.348489575088024' (1x, 0.1%)
   Stats: min=2.17, max=2.54, mean=2.34, median=2.34
   Quantiles: p25=2.30, p50=2.34, p75=2.38

ğŸ“Š lat:
   Top 5 Values:
      â€¢ '48.8482070397636' (1x, 0.1%)
      â€¢ '48.829654975522' (1x, 0.1%)
      â€¢ '48.846276485475' (1x, 0.1%)
      â€¢ '48.878113787876' (1x, 0.1%)
      â€¢ '48.88256264247959' (1x, 0.1%)
   Stats: min=48.76, max=48.96, mean=48.86, median=48.86
   Quantiles: p25=48.84, p50=48.86, p75=48.88

ğŸ“Š city:
   Top 10 Values:
      â€¢ 'Paris' (1,056x, 66.5%)
      â€¢ 'Boulogne-Billancourt' (29x, 1.8%)
      â€¢ 'Montreuil' (24x, 1.5%)
      â€¢ 'Saint-Denis' (22x, 1.4%)
      â€¢ 'Issy-les-Moulineaux' (22x, 1.4%)
      â€¢ 'Pantin' (21x, 1.3%)
      â€¢ 'Ivry-sur-Seine' (18x, 1.1%)
      â€¢ 'Vitry-sur-Seine' (17x, 1.1%)
      â€¢ 'CrÃ©teil' (16x, 1.0%)
      â€¢ 'Neuilly-sur-Seine' (16x, 1.0%)
   Length: min=5, max=21, avg=7.4

âœ… No issues found!


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.007s
   â€¢ Total: 0.02s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.191s
   â€¢ Metadata: 6.212s
   â€¢ Data Loading: 2.312s
   â€¢ Audit Checks: 0.017s
   â€¢ Total Table Audit: 0.02s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251020_165906/audit_dim_station.html
ğŸ“„ Results saved to: audit_results/audit_run_20251020_165906/audit_dim_station.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251020_165906/audit_dim_station.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251020_165906/audit_dim_station_summary.csv

======================================================================
ğŸ” Auditing table: dtm_station_distance
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.dtm_station_distance
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 2,516,982 rows
ğŸ” Sampling 10,000 rows from table
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: dtm_station_distance
Total rows in table: 2,516,982
Analyzing sample: 10,000 rows
============================================================


ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
origin_station_code            Int64           - NOT_CHECKED 0 (0.0%)        1,583          
origin_station_name            String          âœ— ERROR      0 (0.0%)        1,566          
dest_station_code              Int64           - NOT_CHECKED 0 (0.0%)        1,580          
dest_station_name              String          âœ— ERROR      0 (0.0%)        1,563          
distance_meters                Float64         - NOT_CHECKED 0 (0.0%)        9,981          
====================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š origin_station_code:
   Top 5 Values:
      â€¢ '8025.0' (15x, 0.1%)
      â€¢ '12033.0' (14x, 0.1%)
      â€¢ '4015.0' (14x, 0.1%)
      â€¢ '15041.0' (14x, 0.1%)
      â€¢ '16006.0' (13x, 0.1%)
   Stats: min=1001.00, max=92008.00, mean=18981.10, median=17004.50
   Quantiles: p25=11044.00, p50=17005.00, p75=22304.00

ğŸ“Š origin_station_name:
   Top 10 Values:
      â€¢ 'Verdun - Carnot' (21x, 0.2%)
      â€¢ 'Gare RER - Canadiens' (18x, 0.2%)
      â€¢ 'Place des Marseillais' (18x, 0.2%)
      â€¢ 'Square Bela Bartok' (18x, 0.2%)
      â€¢ 'Rocher - Laborde' (17x, 0.2%)
      â€¢ 'Paul Bodin - Clichy' (17x, 0.2%)
      â€¢ 'Miromesnil - La BoÃ©tie' (15x, 0.1%)
      â€¢ 'Franquet - Labrouste' (14x, 0.1%)
      â€¢ 'ChÃ¢teau - RÃ©publique' (14x, 0.1%)
      â€¢ 'FranÃ§ois Truffaut - Saint Emilion' (14x, 0.1%)
   Length: min=6, max=58, avg=23.82

ğŸ“Š dest_station_code:
   Top 5 Values:
      â€¢ '40006.0' (14x, 0.1%)
      â€¢ '10020.0' (14x, 0.1%)
      â€¢ '19041.0' (14x, 0.1%)
      â€¢ '20111.0' (14x, 0.1%)
      â€¢ '22603.0' (14x, 0.1%)
   Stats: min=1001.00, max=92008.00, mean=19097.94, median=16615.00
   Quantiles: p25=11048.00, p50=16615.00, p75=22302.00

ğŸ“Š dest_station_name:
   Top 10 Values:
      â€¢ 'RÃ©aumur - Montmartre' (20x, 0.2%)
      â€¢ 'Verdun - Carnot' (17x, 0.2%)
      â€¢ 'RenÃ© Boulanger - Lancry' (17x, 0.2%)
      â€¢ 'Les PlanÃ¨tes' (17x, 0.2%)
      â€¢ 'ChÃ¢teau - RÃ©publique' (16x, 0.2%)
      â€¢ 'Paul Bodin - Clichy' (15x, 0.1%)
      â€¢ 'Place de la Gare' (15x, 0.1%)
      â€¢ 'Gaston Roussel - Commune de Paris' (15x, 0.1%)
      â€¢ 'Gare RER - Canadiens' (15x, 0.1%)
      â€¢ 'Chabrol - d'Hauteville' (14x, 0.1%)
   Length: min=6, max=58, avg=23.91

ğŸ“Š distance_meters:
   Top 5 Values:
      â€¢ '6736.912843904008' (2x, 0.0%)
      â€¢ '1653.4936113201088' (2x, 0.0%)
      â€¢ '4608.875863710973' (2x, 0.0%)
      â€¢ '20165.88367647421' (2x, 0.0%)
      â€¢ '11059.606669328383' (2x, 0.0%)
   Stats: min=78.49, max=23138.38, mean=6920.57, median=6417.71
   Quantiles: p25=4103.51, p50=6417.77, p75=9216.24

ğŸ” Issues Found:

ğŸ“Š Column: origin_station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,566
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,729 rows (37.3%)
      Found chars: ['Ã§', 'Ãª', 'Ã´', 'Ã‰', 'Ã¨', 'Ã¢', "'", 'Ã©']
      Examples: ["Gare de l'Est - Verdun", 'Jean Moulin - Place Victor et HÃ©lÃ¨ne Basch']

ğŸ“Š Column: dest_station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,563
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place du GÃ©nÃ©ral de Gaulle', 'Place Du GÃ©nÃ©ral De Gaulle']
   âš ï¸  SPECIAL CHARS: 3,863 rows (38.6%)
      Found chars: ['Ã§', 'Ãª', 'Ã´', 'Ã‰', 'Ã¨', 'Ã¼', 'Ã¢', '/', 'Ã', "'"]
      Examples: ['CimetiÃ¨re de Montmartre', "Square d'Anvers"]


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.026s
   â€¢ Total: 0.04s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.222s
   â€¢ Metadata: 5.963s
   â€¢ Data Loading: 3.950s
   â€¢ Audit Checks: 0.040s
   â€¢ Total Table Audit: 0.04s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251020_165906/audit_dtm_station_distance.html
ğŸ“„ Results saved to: audit_results/audit_run_20251020_165906/audit_dtm_station_distance.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251020_165906/audit_dtm_station_distance.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251020_165906/audit_dtm_station_distance_summary.csv

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251020_165906
â±ï¸  Total duration: 30.01 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251020_165906/audit.log
======================================================================
