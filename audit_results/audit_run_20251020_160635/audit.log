ğŸ“ Audit run directory: audit_results/audit_run_20251020_160635
ğŸ“ Logs will be saved to: audit_results/audit_run_20251020_160635/audit.log

======================================================================
ğŸ” Auditing table: fct_avaibility
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
âš ï¸  Could not get table metadata from INFORMATION_SCHEMA: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/portfolio-402/datasets/dbt_prod/tables/INFORMATION_SCHEMA.TABLES?prettyPrint=false: Illegal operation on INFORMATION_SCHEMA view: portfolio-402:dbt_prod.INFORMATION_SCHEMA.TABLES
ğŸ“Š Table has 24,417,603 rows
ğŸ” Sampling 10,000 rows from table
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: fct_avaibility
Total rows in table: 24,417,603
Analyzing sample: 10,000 rows
============================================================


ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_code                   Int64           - NOT_CHECKED 0 (0.0%)        1,499          
station_name                   String          âœ— ERROR      0 (0.0%)        1,496          
capacity                       Int64           - NOT_CHECKED 8 (0.1%)        73             
docks_available                Int64           - NOT_CHECKED 0 (0.0%)        66             
mechanical                     Int64           - NOT_CHECKED 0 (0.0%)        61             
ebike                          Int64           - NOT_CHECKED 0 (0.0%)        40             
duedate                        Datetime(time_unit='ns', time_zone='UTC') âœ“ OK         0 (0.0%)        9,986          
bikes_available                Int64           - NOT_CHECKED 0 (0.0%)        70             
rate_bike_available            Float64         - NOT_CHECKED 1,018 (10.2%)   1,043          
rate_dock_available            Float64         - NOT_CHECKED 1,018 (10.2%)   1,050          
bikes_out_of_order             Int64           - NOT_CHECKED 8 (0.1%)        95             
collected_at                   Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,566          
rounded_collected_at           Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,566          
====================================================================================================

ğŸ” Issues Found:

ğŸ“Š Column: station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,496
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,831 rows (38.3%)
      Found chars: ['Ã»', "'", 'Ã¢', 'Ã©', 'Ã´', 'Ã¨', 'Ã ', 'Ãª', 'Ã§', 'Ã‰']
      Examples: ['Capitaine Glarner - Gabriel PÃ©ri', 'Gambetta - PÃ¨re Lachaise']

â±ï¸  Audit duration: 0.02 seconds

ğŸ”’ Closed BIGQUERY connection
ğŸ“„ HTML report saved to: audit_results/audit_run_20251020_160635/audit_fct_avaibility.html
ğŸ“„ Results saved to: audit_results/audit_run_20251020_160635/audit_fct_avaibility.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251020_160635/audit_fct_avaibility.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251020_160635/audit_fct_avaibility_summary.csv

======================================================================
ğŸ” Auditing table: dim_station
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
âš ï¸  Could not get table metadata from INFORMATION_SCHEMA: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/portfolio-402/datasets/dbt_prod/tables/INFORMATION_SCHEMA.TABLES?prettyPrint=false: Illegal operation on INFORMATION_SCHEMA view: portfolio-402:dbt_prod.INFORMATION_SCHEMA.TABLES
ğŸ”‘ Primary key from config: station_code
ğŸ“Š Table has 1,587 rows
âœ… Loaded 1,587 rows into memory

============================================================
Auditing: dim_station
Total rows in table: 1,587
============================================================


ğŸ”‘ Potential primary key column(s): station_code, lat

ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_code                   Int64           - NOT_CHECKED 0 (0.0%)        1,587          
station_name                   String          âœ— ERROR      0 (0.0%)        1,570          
capacity                       Int64           - NOT_CHECKED 0 (0.0%)        72             
lon                            Float64         - NOT_CHECKED 0 (0.0%)        1,586          
lat                            Float64         - NOT_CHECKED 0 (0.0%)        1,587          
city                           String          âœ— ERROR      0 (0.0%)        68             
is_renting                     Boolean         - NOT_CHECKED 0 (0.0%)        2              
is_returning                   Boolean         - NOT_CHECKED 0 (0.0%)        2              
station_plus                   Boolean         - NOT_CHECKED 0 (0.0%)        2              
====================================================================================================

ğŸ” Issues Found:

ğŸ“Š Column: station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,570
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 605 rows (38.1%)
      Found chars: ['Ã®', "'", 'Ã¢', 'Ã©', 'Ã¨', 'Ã´', 'Ã¯', 'Ã§', 'Ã»']
      Examples: ["Quai de l'Horloge - Pont Neuf [station_code=1001]", 'Turbigo - FranÃ§aise [station_code=1007]']

ğŸ“Š Column: city (String)
   Nulls: 0 (0.0%)
   Distinct values: 68
   âš ï¸  SPECIAL CHARS: 57 rows (3.6%)
      Found chars: ['Ã¢', "'", 'Ã©', 'Ã¨', 'Ãª', 'Ã']
      Examples: ['Saint-MandÃ© [station_code=12041]', 'SÃ¨vres [station_code=23101]']

â±ï¸  Audit duration: 0.01 seconds

ğŸ”’ Closed BIGQUERY connection
ğŸ“„ HTML report saved to: audit_results/audit_run_20251020_160635/audit_dim_station.html
ğŸ“„ Results saved to: audit_results/audit_run_20251020_160635/audit_dim_station.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251020_160635/audit_dim_station.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251020_160635/audit_dim_station_summary.csv

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251020_160635
â±ï¸  Total duration: 14.62 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251020_160635/audit.log
======================================================================
