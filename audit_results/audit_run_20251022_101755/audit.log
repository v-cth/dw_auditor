ğŸ“ Audit run directory: audit_results/audit_run_20251022_101755
ğŸ“ Logs will be saved to: audit_results/audit_run_20251022_101755/audit.log
âœ“ Check mode: Running quality checks only (skipping profiling/insights)

======================================================================
ğŸ’° Estimating BigQuery scan costs...
======================================================================
âœ… Connected to BIGQUERY
   ğŸ” Estimating query: SELECT station_name, collected_at, rounded_collected_at FROM `dbt_prod.fct_avaibility` ORDER BY RAND() LIMIT 10000
   ğŸ” Estimating query: SELECT station_code, station_name, city FROM `dbt_prod.dim_station`
   ğŸ” Estimating query: SELECT origin_station_name, dest_station_name FROM `dbt_prod.dtm_station_distance` ORDER BY RAND() LIMIT 10000
ğŸ”’ Closed BIGQUERY connection

ğŸ“Š Estimated bytes to scan per table:
   â€¢ fct_avaibility: 1.04 GB (sampled)
   â€¢ dim_station: 69.44 KB
   â€¢ dtm_station_distance: 132.50 MB (sampled)

ğŸ’¾ Total estimated data to scan: 1.17 GB (0.0012 TB)
ğŸ’µ Estimated cost (on-demand): $0.01 USD
   (Note: First 1 TB/month is free; pricing may vary by region)

âš ï¸  Do you want to proceed with the audit?
   Type 'y' or 'yes' to continue, or 'n' to cancel: 
âš ï¸  Running in non-interactive mode, proceeding with audit...
   (Use --yes flag in future to skip this prompt)

âœ… Proceeding with audit...

======================================================================
ğŸ” Auditing table: fct_avaibility
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.fct_avaibility
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 24,487,775 rows
ğŸ“Š Optimized column loading: selecting 3/13 columns
ğŸ” Sampling 10,000 rows from table using 'random' method
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: fct_avaibility
Total rows in table: 24,487,775
Analyzing sample: 10,000 rows
============================================================


ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_name                   String          âœ— ERROR      0 (0.0%)        1,493          
collected_at                   Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,583          
rounded_collected_at           Datetime(time_unit='ns', time_zone=None) âœ“ OK         0 (0.0%)        7,581          
====================================================================================================

ğŸ” Issues Found:

ğŸ“Š Column: station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,493
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,810 rows (38.1%)
      Found chars: ['Ã«', 'Ã§', 'Ã¢', 'Ã¨', 'Ã®', "'", 'Ã©', 'Ãª', 'Ã‰', 'Ã ']
      Examples: ['GalilÃ©e - KlÃ©ber', 'Carnot - PÃ¢querettes']


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.040s
   â€¢ date_checks: 0.015s
   â€¢ Total: 0.06s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 62.889s
   â€¢ Metadata: 6.383s
   â€¢ Column Selection: 2.655s
   â€¢ Data Loading: 3.919s
   â€¢ Audit Checks: 0.055s
   â€¢ Total Table Audit: 0.06s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251022_101755/fct_avaibility/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251022_101755/fct_avaibility/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251022_101755/fct_avaibility/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251022_101755/fct_avaibility/summary.csv

======================================================================
ğŸ” Auditing table: dim_station
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.dim_station
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 1,587 rows
ğŸ”‘ Primary key from config: station_code
ğŸ“Š Optimized column loading: selecting 3/9 columns
âœ… Loaded 1,587 rows into memory

============================================================
Auditing: dim_station
Total rows in table: 1,587
============================================================


ğŸ”‘ Potential primary key column(s): station_code

ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
station_code                   Int64           - NOT_CHECKED 0 (0.0%)        1,587          
station_name                   String          âœ— ERROR      0 (0.0%)        1,570          
city                           String          âœ— ERROR      0 (0.0%)        68             
====================================================================================================

ğŸ” Issues Found:

ğŸ“Š Column: station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,570
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 605 rows (38.1%)
      Found chars: ['Ã§', 'Ã¨', 'Ã¢', 'Ã®', 'Ã©', "'", 'Ã¯', 'Ã»', 'Ã´']
      Examples: ["Quai de l'Horloge - Pont Neuf [station_code=1001]", 'Turbigo - FranÃ§aise [station_code=1007]']

ğŸ“Š Column: city (String)
   Nulls: 0 (0.0%)
   Distinct values: 68
   âš ï¸  SPECIAL CHARS: 57 rows (3.6%)
      Found chars: ['Ã¨', 'Ã¢', "'", 'Ã©', 'Ãª', 'Ã']
      Examples: ['Saint-MandÃ© [station_code=12041]', 'SÃ¨vres [station_code=23101]']


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.012s
   â€¢ Total: 0.01s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.344s
   â€¢ Metadata: 5.672s
   â€¢ Column Selection: 2.849s
   â€¢ Data Loading: 3.138s
   â€¢ Audit Checks: 0.014s
   â€¢ Total Table Audit: 0.01s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251022_101755/dim_station/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251022_101755/dim_station/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251022_101755/dim_station/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251022_101755/dim_station/summary.csv

======================================================================
ğŸ” Auditing table: dtm_station_distance
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: portfolio-402.dbt_prod.dtm_station_distance
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 2,516,982 rows
ğŸ“Š Optimized column loading: selecting 2/5 columns
ğŸ” Sampling 10,000 rows from table using 'random' method
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: dtm_station_distance
Total rows in table: 2,516,982
Analyzing sample: 10,000 rows
============================================================


ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
origin_station_name            String          âœ— ERROR      0 (0.0%)        1,568          
dest_station_name              String          âœ— ERROR      0 (0.0%)        1,569          
====================================================================================================

ğŸ” Issues Found:

ğŸ“Š Column: origin_station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,568
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,854 rows (38.5%)
      Found chars: ['Ã§', 'Ã¢', 'Ã¨', 'Ã®', "'", 'Ã©', 'Ã ', 'Ã´']
      Examples: ['VÃ©ron - Lepic', 'PavÃ© des Gardes - Charles Vaillant']

ğŸ“Š Column: dest_station_name (String)
   Nulls: 0 (0.0%)
   Distinct values: 1,569
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']
   âš ï¸  SPECIAL CHARS: 3,850 rows (38.5%)
      Found chars: ['Ã¼', 'Ã§', 'Ã¢', 'Ã¨', 'Ã®', "'", 'Ã©', 'Ãª', 'Ã‰', 'Ã»']
      Examples: ['Place Jean-Baptiste ClÃ©ment', "Place des Droits de l'Enfant"]


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.025s
   â€¢ Total: 0.02s

ğŸ”’ Closed BIGQUERY connection

â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.252s
   â€¢ Metadata: 5.982s
   â€¢ Column Selection: 2.359s
   â€¢ Data Loading: 2.937s
   â€¢ Audit Checks: 0.026s
   â€¢ Total Table Audit: 0.02s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251022_101755/dtm_station_distance/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251022_101755/dtm_station_distance/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251022_101755/dtm_station_distance/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251022_101755/dtm_station_distance/summary.csv

======================================================================
ğŸ“Š Generating run summary reports...
======================================================================
ğŸ“„ Summary HTML saved to: audit_results/audit_run_20251022_101755/summary.html
ğŸ“„ Summary JSON saved to: audit_results/audit_run_20251022_101755/summary.json
ğŸ“„ Detailed column summary CSV saved to: audit_results/audit_run_20251022_101755/columns.csv
ğŸ“„ Table summary CSV saved to: audit_results/audit_run_20251022_101755/tables.csv

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251022_101755
â±ï¸  Total duration: 120.20 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251022_101755/audit.log
======================================================================
