# ============================================================================
# Database Audit Configuration Examples
# ============================================================================
# Example configurations for BigQuery and Snowflake

# ============================================================================
# Example 1: BigQuery with Service Account
# ============================================================================
bigquery_with_service_account:
  database:
    backend: "bigquery"
    connection_params:
      project_id: "my-gcp-project"
      dataset_id: "analytics"
      credentials_path: "/path/to/service-account-key.json"
    schema: null  # Use dataset_id from connection_params

  tables:
    - users
    - orders
    - products

  sampling:
    sample_size: 100000
    sample_threshold: 1000000
    sample_in_db: true

  security:
    mask_pii: true
    custom_pii_keywords:
      - "customer_id"
      - "user_email"

  output:
    directory: "audit_results/bigquery"
    formats:
      - html
      - json
    file_prefix: "bq_audit"

# ============================================================================
# Example 2: BigQuery with Application Default Credentials
# ============================================================================
bigquery_with_adc:
  database:
    backend: "bigquery"
    connection_params:
      project_id: "my-gcp-project"
      dataset_id: "analytics"
      # No credentials_path - uses Application Default Credentials
    schema: null

  tables:
    - dim_customers
    - fact_sales

  sampling:
    sample_size: 50000
    sample_threshold: 500000
    sample_in_db: true

  security:
    mask_pii: true

  output:
    directory: "audit_results"
    formats: [html]
    file_prefix: "audit"

# ============================================================================
# Example 3: Snowflake with Basic Authentication
# ============================================================================
snowflake_basic:
  database:
    backend: "snowflake"
    connection_params:
      account: "my-account"
      user: "audit_user"
      password: "secure_password"
      database: "ANALYTICS_DB"
      warehouse: "COMPUTE_WH"
      schema: "PUBLIC"
      role: "ANALYST_ROLE"
    schema: null  # Use schema from connection_params

  tables:
    - CUSTOMERS
    - ORDERS
    - PRODUCTS

  sampling:
    sample_size: 100000
    sample_threshold: 1000000
    sample_in_db: true

  security:
    mask_pii: true
    custom_pii_keywords:
      - "ssn"
      - "tax_id"
      - "account_num"

  output:
    directory: "audit_results/snowflake"
    formats:
      - html
      - csv
      - json
    file_prefix: "sf_audit"

# ============================================================================
# Example 4: Snowflake with Custom Queries
# ============================================================================
snowflake_custom_queries:
  database:
    backend: "snowflake"
    connection_params:
      account: "my-account"
      user: "audit_user"
      password: "secure_password"
      database: "PROD_DB"
      warehouse: "AUDIT_WH"
      schema: "ANALYTICS"

  tables:
    # Simple table name
    - CUSTOMERS

    # Table with custom query
    - name: recent_orders
      query: "SELECT * FROM ORDERS WHERE ORDER_DATE >= DATEADD(day, -30, CURRENT_DATE())"

    - name: active_users
      query: "SELECT * FROM USERS WHERE STATUS = 'ACTIVE' AND LAST_LOGIN >= DATEADD(day, -7, CURRENT_DATE())"

  sampling:
    sample_size: 50000
    sample_threshold: 500000
    sample_in_db: true

  checks:
    trailing_spaces: true
    case_duplicates: true
    special_characters: true
    numeric_strings: true
    timestamp_patterns: true

  thresholds:
    numeric_string_pct: 85
    constant_hour_pct: 95
    midnight_pct: 98

  security:
    mask_pii: true

  output:
    directory: "audit_results"
    formats: [html, json]
    file_prefix: "audit"

# ============================================================================
# Example 5: BigQuery - Production Audit with Filtering
# ============================================================================
bigquery_production:
  database:
    backend: "bigquery"
    connection_params:
      project_id: "prod-data-warehouse"
      dataset_id: "reporting"
      credentials_path: "/etc/secrets/bq-audit-key.json"

  tables:
    - fact_transactions
    - dim_users
    - dim_products

  sampling:
    sample_size: 250000
    sample_threshold: 5000000
    sample_in_db: true

  security:
    mask_pii: true
    custom_pii_keywords:
      - "email"
      - "phone"
      - "address"
      - "credit_card"

  filters:
    # Only audit specific columns
    include_columns:
      - "user_id"
      - "transaction_date"
      - "amount"
      - "status"
    # Skip these columns
    exclude_columns:
      - "internal_notes"
      - "system_metadata"

  output:
    directory: "/mnt/audit_reports"
    formats:
      - html
      - json
      - csv
    file_prefix: "prod_audit"

# ============================================================================
# Example 6: Minimal Configuration
# ============================================================================
minimal_bigquery:
  database:
    backend: "bigquery"
    connection_params:
      project_id: "my-project"
      dataset_id: "my_dataset"

  tables:
    - users
    - orders

  output:
    directory: "audit_results"
    formats: [html]

minimal_snowflake:
  database:
    backend: "snowflake"
    connection_params:
      account: "my-account"
      user: "my-user"
      password: "my-password"
      database: "my_db"
      warehouse: "my_warehouse"

  tables:
    - CUSTOMERS

  output:
    directory: "audit_results"
    formats: [html]
